# Copilot Chat 10 選 - 骨子・見出し・対話プロット

**記事タイトル**: 【対話で学ぶ】GitHub Copilot Chat の隠れた便利機能 10 選  
**副題**: テスト・リファクタ・執筆を爆速化する AI 相棒の使いこなし術  
**文字数**: 6,000〜7,500 字  
**公開予定**: 10 月 18 日（金）18:00

---

## 全体構成

### 導入（200 字）

前回の「Playwright × AI」記事の自然な流れから、Copilot Chat の実践的な使い方へ。

「テスト自動化だけじゃない、日常の開発を爆速化する 10 の裏技を対話形式で紹介します」

※ 前回記事との接続を明示し、シリーズの連続性を保つ。

### 登場人物紹介（固定文）

この記事では、開発経験 1 年の「ユイ」と、AI 活用のベテラン「レン先輩」の対話を通じて、GitHub Copilot Chat の隠れた便利機能を物語形式で分かりやすく解説します。

> 💡 このシリーズの特徴
> 技術書のような堅苦しい説明ではなく、「会話」で学びます。実際の開発現場でのやり取りをイメージしながら読み進めてください。

### 本編（10 機能 × 500-700 字）

各機能ごとに以下の構成：

1. **ユイの質問**（読者の疑問を代弁）
2. **レンの回答**（結論を一言で）
3. **具体例の提示**（プロンプト例＋ AI 回答例）
4. **ひとこと Tips**（💡 マーク）で追加の活用法を提示

### まとめ（300 字）

10 機能の復習＋次回予告「CI 強化と失敗の潰し方」へ導線

---

## 機能 1: 読みやすい Diff 解説（修正理由の要約）

### 対話プロット

ユイ: PR のレビュー依頼が来たんですけど、変更差分が多すぎて何が本質的な変更なのか分かりません…。

レン: それ、Copilot Chat に Diff を貼って「この変更の要点を 3 行で要約して」って頼むといいよ。ノイズ（インデント調整・import 追加）と本質的な変更を分けて説明してくれる。

### 作例（プロンプト）

```
以下のDiffの変更を3行で要約してください。特に本質的な変更に注目してください。

[Diffを貼り付け]
```

**Copilot の回答例**:

```
1. `calculateTotal` 関数のロジックを税率計算に対応（消費税10%）
2. テストケースに境界値（0円・負の値）を追加
3. インデント調整とimport文の整理（機能的な変更なし）
```

### ひとこと Tips 💡

複雑なリファクタ PR は、「この変更前後でテストが壊れる可能性ある？」と追加質問すると、レビューポイントを絞り込める。

---

## 機能 2: テストコード生成の叩き（前提条件を明文化）

### 対話プロット

ユイ: Copilot に「テスト書いて」って頼んだら、モックだらけの複雑なテストが出てきて逆に困りました…。

レン: それ、前提条件を明記してないから汎用的すぎるテストになっちゃうんだよね。「Jest で、モック不要、境界値含めて」みたいに条件を絞ると精度が上がるよ。

### 作例（プロンプト）

❌ **曖昧な依頼**:

```
この関数のテストを書いて
```

⭕ **明確な依頼**:

```
以下の関数のテストを書いてください。
- テストフレームワーク: Jest
- モック: 不要（純粋関数）
- カバー範囲: 正常系・境界値（0, 負の値）・エラーハンドリング
- アサーション: toEqual を使用

[関数のコードを貼り付け]
```

### ひとこと Tips 💡

「テストの意図をコメントで説明して」と追加すると、後から読んでも理解しやすいテストになる。

---

## 機能 3: エラーログ要約＋再現ステップ抽出

### 対話プロット

ユイ: CI でテストが落ちたんですけど、ログが長すぎて原因が分かりません…スタックトレース読むの苦手で。

レン: それ、Copilot Chat にログを貼って「エラーの原因と再現ステップを箇条書きで」って頼むと一発だよ。ノイズ（info/debug ログ)を除外して、本質的なエラー部分だけ抽出してくれる。

### 作例（プロンプト）

```
以下のエラーログから、原因と再現ステップを箇条書きで抽出してください。

[エラーログを貼り付け]
```

**Copilot の回答例**:

```
【原因】
- `getByTestId('submit-btn')` のセレクタが見つからない
- 原因: ボタンのdata-testid属性が `submit-button` に変更されている

【再現ステップ】
1. ログインページにアクセス
2. フォームに入力
3. 送信ボタンをクリック → エラー発生

【修正案】
`getByTestId('submit-button')` に修正
```

### ひとこと Tips 💡

「このエラーの優先度は？（高/中/低）」と追加質問すると、どのエラーから潰すべきか判断しやすい。

---

## 機能 4: セレクタ改善アドバイス（role/testid 優先）

### 対話プロット

ユイ: Playwright のセレクタ、class 名で指定してたら突然 CI で壊れました…何が悪かったんでしょう？

レン: class 名やテキストは変更に弱いから、本番では使わない方がいいね。Copilot Chat にコードを貼って「セレクタを改善して」って頼むと、`getByRole` や `getByTestId` を提案してくれるよ。

### 作例（プロンプト）

```
以下のPlaywrightコードのセレクタを改善してください。
- class名やテキストベースのセレクタは避ける
- getByRole または getByTestId を優先

[コードを貼り付け]
```

❌ **改善前**:

```javascript
await page.locator(".btn-primary").click();
```

⭕ **改善後**:

```javascript
await page.getByRole("button", { name: "送信" }).click();
// または
await page.getByTestId("submit-btn").click();
```

### ひとこと Tips 💡

「このページのアクセシビリティを改善するセレクタを提案して」と頼むと、WAI-ARIA 対応の role 指定を学べる。

---

## 機能 5: 待機戦略の言語化（explicit wait/条件分岐）

### 対話プロット

ユイ: Playwright で「要素が見つかりません」エラーが頻発します。待機時間を増やせばいいんでしょうか？

レン: 単純に待機時間を増やすだけだと、テストが遅くなるしそれでも落ちる時がある。Copilot Chat に「この操作の適切な待機戦略を教えて」って頼むと、`waitForSelector` の使い分けを提案してくれるよ。

### 作例（プロンプト）

```
以下のPlaywrightコードで「要素が見つかりません」エラーが発生します。
適切な待機戦略を提案してください。

[コードを貼り付け]
```

❌ **改善前**:

```javascript
await page.locator("#result").click();
```

⭕ **改善後**:

```javascript
// API通信後に表示される要素なので、明示的待機を追加
await page.waitForSelector("#result", { state: "visible" });
await page.locator("#result").click();
```

### ひとこと Tips 💡

「この待機は state: 'visible' と state: 'attached' のどちらが適切？」と追加質問すると、シーン別の使い分けを学べる。

---

## 機能 6: CLI/設定の最小化テンプレ提案

### 対話プロット

ユイ: Playwright の設定ファイル、公式ドキュメントのサンプルが複雑すぎて何が必須なのか分かりません…。

レン: それ、Copilot Chat に「Playwright の最小構成の playwright.config.ts を作って」って頼むと、必須項目だけのテンプレを出してくれる。オプション設定は後から追加すれば OK。

### 作例（プロンプト）

```
Playwright の最小構成の playwright.config.ts を作成してください。
- ブラウザ: Chromium のみ
- ヘッドレスモード
- レポート: HTML形式
- 不要なオプションは除外
```

**Copilot の回答例**:

```typescript
import { defineConfig } from "@playwright/test";

export default defineConfig({
  testDir: "./e2e",
  use: {
    headless: true,
    viewport: { width: 1280, height: 720 },
  },
  reporter: "html",
  projects: [
    {
      name: "chromium",
      use: { ...devices["Desktop Chrome"] },
    },
  ],
});
```

### ひとこと Tips 💡

「この設定に CI 用の最適化を追加して」と追加依頼すると、`workers: 4` やタイムアウト設定を提案してくれる。

---

## 機能 7: リファクタ案（関数抽出・依存分離）

### 対話プロット

ユイ: この関数、100 行超えてて読みにくいんですけど、どう分割すればいいか分かりません…。

レン: それ、Copilot Chat に「この関数をリファクタして」って頼むと、適切な粒度で関数を分割してくれる。「Single Responsibility Principle（単一責任の原則）を守って」と追加すると、より洗練されるよ。

### 作例（プロンプト）

```
以下の関数をリファクタしてください。
- 関数を適切な粒度で分割
- 単一責任の原則を守る
- 元の動作は変えない

[長い関数のコードを貼り付け]
```

**Copilot の回答例**:

```javascript
// Before: 100行の巨大関数

// After: 役割ごとに分割
async function processOrder(order) {
  const validated = validateOrder(order);
  const calculated = calculateTotal(validated);
  const saved = await saveToDatabase(calculated);
  await sendNotification(saved);
  return saved;
}

function validateOrder(order) {
  /* ... */
}
function calculateTotal(order) {
  /* ... */
}
// ...
```

### ひとこと Tips 💡

「このリファクタで追加すべきテストケースは？」と追加質問すると、境界値や例外ケースを洗い出せる。

---

## 機能 8: テストデータ設計支援（境界値/同値分割）

### 対話プロット

ユイ: テストデータ、適当に「正常系 1 パターン」だけ書いちゃったんですけど、これで大丈夫ですかね…？

レン: それだとバグ見逃す可能性高いね。Copilot Chat に「この関数の境界値と同値分割を教えて」って頼むと、網羅すべきテストケースを一覧で出してくれるよ。

### 作例（プロンプト）

```
以下の関数のテストケースを、境界値分析と同値分割の手法で網羅的に列挙してください。

function calculateDiscount(price, userType) {
  if (price < 0) throw new Error('Invalid price');
  if (price >= 10000 && userType === 'premium') return price * 0.8;
  if (price >= 5000) return price * 0.9;
  return price;
}
```

**Copilot の回答例**:

```
【境界値】
- price: -1, 0, 1, 4999, 5000, 5001, 9999, 10000, 10001
- userType: 'premium', 'normal', null, undefined

【同値分割】
1. price < 0 → エラー
2. 0 <= price < 5000 → 割引なし
3. 5000 <= price < 10000 → 10%割引
4. price >= 10000 && userType === 'premium' → 20%割引
5. price >= 10000 && userType !== 'premium' → 10%割引

【推奨テストケース】
- (-1, 'normal') → Error
- (0, 'normal') → 0
- (4999, 'normal') → 4999
- (5000, 'normal') → 4500
- (9999, 'premium') → 8999.1
- (10000, 'premium') → 8000
- (10001, 'normal') → 9000.9
```

### ひとこと Tips 💡

「このテストケースを Jest の test.each で書いて」と追加依頼すると、パラメタライズドテストのコードを生成してくれる。

---

## 機能 9: CI ログの失敗原因の分類（環境/時間/データ）

### 対話プロット

ユイ: CI で 3 つのテストが同時に落ちたんですけど、全部別々に調査するのしんどいです…。

レン: それ、Copilot Chat にログを貼って「失敗原因を環境・時間・データの観点で分類して」って頼むと、共通の根本原因を見つけやすくなるよ。

### 作例（プロンプト）

```
以下のCIログから、テスト失敗の原因を以下の観点で分類してください。
- 環境起因（OS/ブラウザ/依存ライブラリ）
- 時間起因（タイムアウト/タイミング依存）
- データ起因（テストデータ不足/不正）

[CIログを貼り付け]
```

**Copilot の回答例**:

```
【環境起因】
- Test A: Chromium 120 で font-family が期待値と異なる → スクリーンショット比較失敗

【時間起因】
- Test B: API通信が3秒以上かかり、デフォルトタイムアウト（5秒）に引っかかる
- Test C: 並列実行時にDBロックが発生

【データ起因】
- なし（今回のログでは該当なし）

【推奨対応】
1. Test A: スクリーンショット比較のthresholdを緩和
2. Test B: API通信の明示的待機を追加
3. Test C: テスト分離（トランザクション分割）
```

### ひとこと Tips 💡

「この 3 つの失敗、優先度順に並べて」と追加質問すると、どれから潰すべきか一目瞭然。

---

## 機能 10: 執筆支援（要点箇条書き → 章立て → サマリ）

### 対話プロット

ユイ: 技術ブログ書きたいんですけど、箇条書きメモから記事にするのが苦手で…構成が思いつきません。

レン: それ、Copilot Chat に箇条書きメモを貼って「この内容を記事の章立てにして」って頼むと、序論 → 本論 → 結論の流れを自動で作ってくれるよ。そのあと「各章を 300 字で執筆して」と追加依頼すれば一気に仕上がる。

### 作例（プロンプト）

**ステップ 1: 章立て生成**

```
以下の箇条書きメモを、技術ブログ記事の章立てに変換してください。
- 読者: Playwright 初心者
- 目的: CI失敗の原因と対処法を理解
- 内容: タイムアウト、セレクタ、環境差異、並列実行

[箇条書きメモを貼り付け]
```

**Copilot の回答例**:

```
【タイトル案】
Playwright のCI失敗を30分で潰す実践ガイド

【章立て】
1. はじめに（CIで困ってませんか？）
2. 失敗パターン1: タイムアウト地獄
3. 失敗パターン2: セレクタが壊れる
4. 失敗パターン3: ローカルOK・CINGO
5. 失敗パターン4: 並列実行で競合
6. まとめ（30分で安定CIを実現）
```

**ステップ 2: 執筆支援**

```
「2. 失敗パターン1: タイムアウト地獄」の章を300字で執筆してください。
- 初心者にも分かりやすく
- 対話形式（質問→回答）
```

### ひとこと Tips 💡

「この記事の要約を 50 字で」と追加依頼すると、X 投稿用のキャッチコピーを生成できる。

---

### まとめ（300 字）

GitHub Copilot Chat は「テスト生成」だけじゃなく、日常の開発を爆速化する隠れた便利機能がたくさんあります。

今回紹介した 10 の機能を使えば、

- Diff 解説の要約でレビュー時間を短縮
- エラーログ分析で原因特定を高速化
- セレクタ改善でテストの安定性向上
- 執筆支援でブログ・ドキュメント作成を効率化

など、開発のあらゆる場面で AI 相棒の力を借りられます。

**まとめの対話**:

レン: ユイ、今日で Copilot Chat の隠れた便利機能が分かったね。AI と組み合わせると、こんなに便利なんだ。

ユイ: はい！重要なのは「何をしたいか」を明確に伝えることで、技術的な実装は AI が助けてくれるんですね。

レン: その通り。これからはもっと進化して、AI が自動でコードレビューしたり、バグを見つけたりする時代が来るよ。

ユイ: 楽しみです！まずは今日教えてもらった 10 の機能を、自分のプロジェクトで試してみます。

レン: がんばって。分からないことがあれば、いつでも Copilot Chat に聞けばいい。AI は 24 時間働いてくれる最高の相棒だからね。

次回は、今回の「CI ログ失敗原因の分類」を実践編に展開し、**【対話で学ぶ】Playwright の CI 失敗を 30 分で潰す実践ガイド** をお届けします。タイムアウト・セレクタ・環境差異を対話形式で解決する方法を、Before/After ログ比較付きで解説します。

- 公開予定: 10 月 25 日（金）18:00
- 続編の通知がほしい方は、ぜひ ❤️ やフォローで教えてください！

[次回予告テンプレートをここに挿入]

---

## 執筆時の注意点

1. **対話形式 70%を厳守**: 各機能で初心者の質問 → メンター回答のパターンを崩さない
2. **作例は短く**: コードブロックは 5-10 行以内。長い場合は Gist リンクで補足
3. **ひとこと Tips を活用**: 追加質問のパターンを提示し、読者の学びを深める
4. **前回記事との接続**: 導入部で「Playwright × AI」記事への言及を忘れない
5. **次回予告の配置**: まとめの最後に `note_next_article_template.md` を挿入

---

## 次のアクション

- [ ] 各機能の対話プロットを実際の会話調に肉付け（300-500 字/機能）
- [ ] 作例のコードブロックを実行可能な形で検証
- [ ] X 投稿用のキャッチコピーを抽出（50 字 × 4 パターン）
- [ ] アイキャッチ画像の英語版を生成（10 月 17 日までに）

この Outline をベースに、Week1 のメイン記事を仕上げていきます 🚀
