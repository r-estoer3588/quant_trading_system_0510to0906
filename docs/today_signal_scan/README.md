# 今日のシグナル処理 - 7 フェーズ詳細

システムの核となるシグナル処理フローの詳細解説です。

## 📋 処理フェーズ一覧

| フェーズ    | ドキュメント                                                       | 主な処理内容               |
| ----------- | ------------------------------------------------------------------ | -------------------------- |
| **Phase 0** | [実行全体の流れ](./1.%20実行全体の流れ.md)                         | 対象シンボル準備・鮮度検証 |
| **Phase 1** | [実行全体の流れ](./1.%20実行全体の流れ.md)                         | 進捗初期化                 |
| **Phase 2** | [基礎データ読込](./2.%20基礎データ読込フェーズ.md)                 | キャッシュからのデータ取得 |
| **Phase 3** | [フィルター実行](./3.%20フィルター実行フェーズ.md)                 | Two-Phase 1 段階目         |
| **Phase 4** | [セットアップ評価](./4.%20セットアップ評価フェーズ.md)             | Two-Phase 2 段階目         |
| **Phase 5** | [シグナル抽出](./5.%20シグナル抽出フェーズ（トレード候補選定）.md) | ランキング・候補選定       |
| **Phase 6** | [配分・最終リスト生成](./6.%20配分・最終リスト生成フェーズ.md)     | 資金配分・最終決定         |
| **Phase 7** | [保存・通知](./7.%20保存・通知フェーズ.md)                         | CSV 出力・Slack 通知       |

> **Phase 0 の重要性**: rolling キャッシュの鮮度を検証し、古いデータの銘柄を除外することで、誤ったシグナルを防ぎます。除外銘柄は `logs/excluded_symbols_YYYYMMDD.csv` に保存され、デリバティブ銘柄（W/R/U 末尾）やデータ欠損銘柄が主な対象となります。

> **注記**: 共有指標計算（ROC, ADX, RSI 等）は当日パイプラインでは実施されません。`scripts/build_rolling_with_indicators.py` により事前計算され、rolling キャッシュに保存されています。

## 🔄 Two-Phase 処理の詳細

### [Two-Phase & ランキングルール](./two-phaze_and_rank_rule.md)

- **Phase 1**: フィルター条件による一次スクリーニング（Phase 3）
- **Phase 2**: セットアップ条件による二次スクリーニング（Phase 4）
- **ランキング**: システム別スコアリング（ROC200, ADX7 等）（Phase 5）
- **配分**: 最終候補の資金配分決定（Phase 6）

## 🗃️ データフロー概要

```
Universe準備 → データ読込 → [事前計算済み指標]
     ↓
フィルター → セットアップ → シグナル抽出
     ↓
配分決定 → CSV保存 → 通知送信
```

### キャッシュ階層

- **rolling** (直近 300 日) → **base** (長期) → **full_backup** (原本)
- Today 用: rolling 優先、Backtest 用: base 優先
- **指標事前計算**: `scripts/build_rolling_with_indicators.py` により rolling キャッシュ生成時に実施

## 🔗 関連ドキュメント

- [技術文書](../technical/) - 全体アーキテクチャ
- [システム仕様](../systems/) - System1-7 詳細仕様
- [必須指標](../technical/required_indicators.md) - 計算ロジック
- [運用ガイド](../operations/) - 自動実行・通知設定
